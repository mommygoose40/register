<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>防汛志工註冊表單</title>
  <style>
    /* === 基本排版設定 === */
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f8ff;  /* 背景顏色 */
      color: #000;                /* 文字顏色 */
      margin: 0;
      padding: 0;
    }

    /* 內容區域的最大寬度 */
    .container {
      max-width: 800px;
      margin: 0 auto;   /* 居中 */
      padding: 20px;
    }

    /* 頁面標題樣式 */
    .header {
      text-align: center;
      color: #000;
      border-bottom: 2px solid #0b5ed7; /* 底部藍色邊框 */
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    /* 步驟標題樣式 */
    .step-title {
      font-weight: 700;
      font-size: 22px;
      color: #000;
      margin-bottom: 14px;
    }

    /* 表單區塊樣式 */
    .form-section {
      background: white;
      border-radius: 8px;
      border: 2px solid #d0d7e2;  /* 輕灰色邊框 */
      padding: 20px;
      margin-bottom: 20px;
    }

    /* 輸入框的樣式 */
    label {
      font-size: 21px;  /* 文字大小與異常類型選項一致 */
      color: #333;
      margin-bottom: 8px;
      display: inline-block;
    }

    input[type="text"],
    input[type="number"] {
      padding: 12px;
      width: 95%;
      border: 2px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
      margin-bottom: 10px;
    }

    /* 按鈕樣式 */
    .ui-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 16px;  /* 減少按鈕的間距，讓它看起來不那麼大 */
      margin: 6px 4px;             /* 按鈕外邊距 */
      background: #0b5ed7;         /* 藍色按鈕背景顏色 */
      color: #fff;                 /* 文字顏色 */
      border: none;                /* 去除邊框 */
      border-radius: 6px;          /* 圓角設計 */
      font-size: 18px;             /* 字體大小較小，與其他元素一致 */
      cursor: pointer;
    }

    .ui-btn:active {
      filter: brightness(0.7);  /* 按鈕被按下時的亮度變暗效果 */
    }

    /* 灰色型按鈕 */
    .ui-btn.gray {
      background: #60748f;
    }

    /* 提交按鈕 */
    .submit-btn {
      background: #0b5ed7;
      font-size: 18px;  /* 字體大小 */
      color: white;
      padding: 10px 20px;  /* 合適的按鈕間距 */
      border-radius: 6px;
      cursor: pointer;
      width: 100%;
    }

    .submit-btn:hover {
      background: #0a4a91;
    }

  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>註冊表單</h1>
    </div>

    <div class="form-section">
      <label for="name">姓名</label>
      <input type="text" id="name" name="name" required>

      <label for="division">第幾大隊</label>
      <input type="number" id="division" name="division" required>

      <label for="team">第幾小隊（選填）</label>
      <input type="number" id="team" name="team">

      <label for="lineName">Line 暱稱</label>
      <input type="text" id="lineName" name="lineName" required>
    </div>

    <!-- 按鈕區域 -->
    <div style="display: flex; justify-content: space-between;">
      <button class="ui-btn gray" onclick="window.close()">關閉頁面</button>
      <button class="submit-btn" type="submit" onclick="submitForm()">提交表單</button>
    </div>
  </div>

  <script>
    function submitForm() {
      const name = document.getElementById('name').value;
      const division = document.getElementById('division').value;
      const team = document.getElementById('team').value;
      const lineName = document.getElementById('lineName').value;

      const formData = new FormData();
      formData.append('姓名', name);       // 使用中文鍵名
      formData.append('大隊', division);   // 使用中文鍵名
      formData.append('小隊', team);       // 使用中文鍵名
      formData.append('Line暱稱', lineName);  // 使用中文鍵名

      fetch('https://script.google.com/macros/s/AKfycbywyP0GiL3xSz5sOEptSGQIKCjPYzUU1GMwM2aUQtJe3eCY9KIV-d21kbnIAUh6e_7m/exec', {
        method: 'POST',
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        if (data.status === 'success') {
          showMessage('提交成功！註冊結果請等候管理員確認');
        } else {
          showMessage('提交失敗，請稍後再試');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        showMessage('提交失敗，請稍後再試');
      });
    }

function showMessage(text, onConfirm) {
  document.getElementById("customModal")?.remove();
  const overlay = document.createElement("div");
  overlay.id = "customModal";
  Object.assign(overlay.style, {
    position: "fixed",
    inset: "0",
    background: "rgba(0,0,0,0.6)",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
    zIndex: "9999",
  });
  const box = document.createElement("div");
  Object.assign(box.style, {
    background: "#fff",
    color: "#000",
    borderRadius: "12px",
    padding: "30px 40px",
    fontSize: "22px",
    textAlign: "center",
    maxWidth: "80%",
    boxShadow: "0 4px 20px rgba(0,0,0,0.3)",
  });
  box.innerHTML = text;

  const btn = document.createElement("button");
  btn.textContent = "確定";
  Object.assign(btn.style, {
    marginTop: "24px",
    fontSize: "20px",
    padding: "10px 28px",
    borderRadius: "8px",
    border: "none",
    background: "#0b5ed7",
    color: "#fff",
  });

  // ← 只改這段：先移除視窗，連續兩次 rAF 確保完成重繪，再執行 onConfirm（開相簿）
  btn.onclick = () => {
    overlay.remove();
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        if (typeof onConfirm === "function") onConfirm();
      });
    });
  };

  box.appendChild(document.createElement("br"));
  box.appendChild(btn);
  overlay.appendChild(box);
  document.body.appendChild(overlay);
}
  </script>
</body>
</html>
