<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>防汛志工註冊表單</title>
  <style>
    /* === 基本排版設定 === */
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f8ff;  /* 背景顏色 */
      color: #000;                /* 文字顏色 */
      margin: 0;
      padding: 0;
    }

    /* 內容區域的最大寬度 */
    .container {
      max-width: 800px;
      margin: 0 auto;   /* 居中 */
      padding: 20px;
      box-sizing: border-box;
    }

    /* 頁面標題樣式 */
    .header {
      text-align: center;
      color: #000;
      border-bottom: 2px solid #0b5ed7; /* 底部藍色邊框 */
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    /* 表單區塊樣式 */
    .form-section {
      background: white;
      border-radius: 8px;
      border: 2px solid #d0d7e2;  /* 輕灰色邊框 */
      padding: 20px;
      margin-bottom: 20px;
      box-sizing: border-box;
    }

    /* 輸入框的樣式 */
    label {
      font-size: 21px;  /* 文字大小 */
      color: #333;
      margin-bottom: 8px;
      display: inline-block;
    }

    input[type="text"],
    input[type="number"] {
      padding: 12px;
      width: 100%;  /* 確保輸入框寬度100% */
      max-width: 100%;  /* 限制最大寬度 */
      border: 2px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
      margin-bottom: 10px;
      box-sizing: border-box; /* 確保padding和border包含在寬度內 */
    }

    /* === 按鈕樣式統一設定 === */
    .ui-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 16px;          /* 較小的內距 */
      background: #0b5ed7;        /* 按鈕背景顏色 */
      color: #fff;                /* 文字顏色 */
      border: none;               /* 去除邊框 */
      border-radius: 6px;         /* 圓角設計 */
      font-size: 21px;            /* 字體大小 */
      line-height: 1.2;           /* 行高設置 */
      text-align: center;         /* 文字居中 */
      cursor: pointer;
      font-weight: normal;        /* 字體不用粗體 */
      min-width: 120px;           /* 確保按鈕寬度一致 */
      height: 42px;               /* 固定高度 */
      box-sizing: border-box;     /* 保證邊框和內邊距不會影響尺寸計算 */
      
      /* 用於觸控設備的優化 */
      -webkit-tap-highlight-color: transparent; 
      -webkit-user-select: none;  /* 禁止文字選擇 */
      user-select: none;          /* 禁止文字選擇 */
      font-family: inherit;  
    }

    /* 按鈕的互動效果 */
    .ui-btn:active {
      filter: brightness(0.7);  /* 按鈕被按下時的亮度變暗效果 */
    }

    /* 灰色型 */
    .ui-btn.gray {
      background: #60748f;
    }

    /* 提交按鈕 */
    .submit-btn {
      background: #0b5ed7;       /* 藍色背景 */
      font-size: 21px;           /* 字體大小 */
      color: white;
      padding: 8px 16px;         /* 較小的內距 */
      border-radius: 6px;
      cursor: pointer;
      border: none;              /* 去除邊框 */
      min-width: 120px;          /* 確保按鈕寬度一致 */
      height: 42px;              /* 固定高度 */
      box-sizing: border-box;    /* 確保padding包含在寬度內 */
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: normal;       /* 字體不用粗體 */
    }

    .submit-btn:hover {
      background: #0a4a91;
    }

    /* 按鈕區域 */
    .button-group {
      display: flex;
      justify-content: center;  /* 置中按鈕 */
      gap: 14px;               /* 較小的間距 */
      margin-top: 10px;
      align-items: center;      /* 垂直置中 */
    }

    /* 去除按鈕陰影 */
    .ui-btn, .submit-btn {
      box-shadow: none;
    }

    /* 表單欄位組 - 緊密間距 */
    .form-field {
      margin-bottom: 15px; /* 較緊密的欄位間距 */
    }

  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>註冊表單</h1>
    </div>

    <div class="form-section">
      <div class="form-field">
        <label for="name">姓名</label>
        <input type="text" id="name" name="name" required>
      </div>

      <div class="form-field">
        <label for="division">第幾大隊</label>
        <input type="number" id="division" name="division" required>
      </div>

      <div class="form-field">
        <label for="team">第幾小隊（選填）</label>
        <input type="number" id="team" name="team">
      </div>

      <div class="form-field">
        <label for="lineName">Line 暱稱</label>
        <input type="text" id="lineName" name="lineName" required>
      </div>
    </div>

    <!-- 按鈕區域 -->
    <div class="button-group">
      <button class="ui-btn gray" onclick="window.close()">關閉頁面</button>
      <button class="submit-btn" type="submit" onclick="submitForm()">提交註冊</button>
    </div>
  </div>

  <script>
    function submitForm() {
      const name = document.getElementById('name').value;
      const division = document.getElementById('division').value;
      const team = document.getElementById('team').value;
      const lineName = document.getElementById('lineName').value;

      // 修正Line暱稱參數名稱，與GAS一致
      const url = `https://script.google.com/macros/s/AKfycbzhfDTfRusiKLmzM-y1mc-JrTj3jhd3k17QxInsjl-_P8O1MNzAdgyI9zkbIhBF7bMT/exec?姓名=${encodeURIComponent(name)}&大隊=${encodeURIComponent(division)}&小隊=${encodeURIComponent(team)}&Line暱稱=${encodeURIComponent(lineName)}`;

      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.status === 'success') {
            showMessage('提交成功！註冊結果請等候管理員確認');
          } else {
            showMessage('提交失敗，請稍後再試');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          showMessage('提交失敗，請稍後再試');
        });
    }

    function showMessage(text, onConfirm) {
      document.getElementById("customModal")?.remove();
      const overlay = document.createElement("div");
      overlay.id = "customModal";
      Object.assign(overlay.style, {
        position: "fixed",
        inset: "0",
        background: "rgba(0,0,0,0.6)",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        zIndex: "9999",
      });
      const box = document.createElement("div");
      Object.assign(box.style, {
        background: "#fff",
        color: "#000",
        borderRadius: "12px",
        padding: "30px 40px",
        fontSize: "22px",
        textAlign: "center",
        maxWidth: "80%",
        boxShadow: "0 4px 20px rgba(0,0,0,0.3)",
      });
      box.innerHTML = text;

      const btn = document.createElement("button");
      btn.textContent = "確定";
      Object.assign(btn.style, {
        marginTop: "24px",
        fontSize: "20px",
        padding: "8px 24px",
        borderRadius: "6px",
        border: "none",
        background: "#0b5ed7",
        color: "#fff",
        fontFamily: "Arial, sans-serif",
      });

      btn.onclick = () => {
        overlay.remove();
        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            if (typeof onConfirm === "function") onConfirm();
          });
        });
      };

      box.appendChild(document.createElement("br"));
      box.appendChild(btn);
      overlay.appendChild(box);
      document.body.appendChild(overlay);
    }
  </script>
</body>
</html>